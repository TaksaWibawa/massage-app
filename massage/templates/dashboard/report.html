{% extends "core/base.html" %}
{% load static %}
{% load templatetags %}
{% block title %}Report{% endblock %}
{% block pageTitle %}
  Report
{% endblock pageTitle %}
{% block content %}
  <section class="section-wrapper justify-content-start mt-5 w-100">
    <form method="GET">
      <div class="filter-wrapper">
        <div class="filter-wrapper__month">
          <div class="select-wrapper">
            <i class="fa-solid fa-play select-icon"></i>
            {{ filter_form.month }}
            <div class="select-arrow"></div>
          </div>
        </div>
      </div>
      <input id="filter-submit" type="submit" value="Filter" hidden>
    </form>
    <table class="report__table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Revenue</th>
          <th>Supervisor Fee</th>
          <th>Employee Fee</th>
          <th>Nett Revenue</th>
        </tr>
      </thead>
      <tbody>
      {% if report %}
        {% for item in report %}
          <tr>
            <td><span>{{ item.date }}</span></td>
            <td><span>{{ item.revenue|currency_format_dot }}</span></td>
            <td><span>{{ item.supervisor_fee|currency_format_dot }}</span></td>
            <td>
              {% if item.employee_fee == 'unpaid' %}
                <span>Unpaid</span>
              {% else %}
                <span>{{ item.employee_fee|currency_format_dot }}</span>
              {% endif %}
            </td>
            <td>
              {% if item.nett_revenue == 'unpaid' %}
                <span>{{ item.revenue|currency_format_dot }} (Unpaid)</span>
              {% else %}
                <span>{{ item.nett_revenue|currency_format_dot }}</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="5"class="empty-row">
            <span>
              No Report Found
            </span>
          </td>
        </tr>
      {% endif %}
      </tbody>
    </table>
  </section>
{% endblock %}
{% block scripts %}
  {{ block.super }}
  <script>
    const filterSubmit = document.getElementById('filter-submit');
    const monthSelect = document.querySelector('.filter-wrapper__month select');
    monthSelect.addEventListener('change', () => filterSubmit.click());
  </script>
{% endblock scripts %}